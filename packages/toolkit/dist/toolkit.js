!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@spiral-toolkit/toolkit",[],t):"object"==typeof exports?exports["@spiral-toolkit/toolkit"]=t():e["@spiral-toolkit/toolkit"]=t()}(window,(function(){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=14)}([function(e,t,n){window,e.exports=function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=2)}([function(e,t){const n=function(e){this._storage={},this._allowedEvents=e};n.prototype.on=function(e,t){e.replace(/\s{2,}/g," ").split(" ").forEach((function(n){this._allowedEvents&&-1===this._allowedEvents.indexOf(n)?console.warn("Events. Try to register event %s, but event is not allowed",n):(this._storage.hasOwnProperty(e)||(this._storage[n]=[]),this._storage[n].push(t))}),this)},n.prototype.registerAction=n.prototype.on,n.prototype.off=function(){alert("You try to remove action. This part is incomplete")},n.prototype.trigger=function(e,t){if(this._allowedEvents&&-1===this._allowedEvents.indexOf(e))console.warn("Events. Try to trigger event %s, but event is not allowed",e);else if(this._storage.hasOwnProperty(e))for(let n=0,s=this._storage[e].length;n<s;n+=1)this._storage[e][n](t)},n.prototype.performAction=n.prototype.trigger,e.exports=n},function(e,t){const n=function(e,t){this.data={},e&&("[object Object]"!==Object.prototype.toString.call(e)?console.warn("LikeFormData can't accept non Object. Please reefer to documentation. Problem parameter is:",e):this.data=e),this.boundary=t||`SpiralFormData-${Math.random().toString().substr(2)}`};n.prototype.append=function(e,t){this.data[e]=t},n.prototype.toString=function(){let e="";const{boundary:t}=this,n=function(s,o){Object.keys(s).forEach(r=>{s.hasOwnProperty(r)&&void 0!==s[r]&&("object"==typeof s[r]?n(s[r],0===o.length?r:`${o}[${r}]`):e+=`--${t}\r\nContent-Disposition: form-data; name=${0===o.length?r:`${o}[${r}]`}\r\n\r\n${s[r]}\r\n`)})};return"object"!=typeof this.data&&(this.data={data:this.data}),n(this.data,""),e+=`--${this.boundary}--\r\n`},n.prototype.delete=function(e){return delete this.data[e]},n.prototype.get=function(e){return this.data[e]},n.prototype.getAll=function(){return this.data},n.prototype.has=function(e){return this.data.hasOwnProperty(e)},n.prototype.set=function(e,t){this.data[e]=t},n.prototype.getContentTypeHeader=function(){return`multipart/form-data; charset=utf-8; boundary=${this.boundary}`},e.exports=n},function(e,t,n){e.exports=n(3)},function(e,t,n){const s=n(4),o={core:s.core,helpers:s.helpers,tools:s.tools};if(n(12),n(13),"function"!=typeof Promise){const{Promise:e}=n(14)}o.hasOwnProperty("options")||(o.options={instances:{}}),o.options.hasOwnProperty("instances")||(o.options.instances={}),window&&!window.hasOwnProperty("sf")&&(window.sf=o),o.instancesController=new o.core.InstancesController(o),o.domMutation=new o.core.DomMutations(o.instancesController),o.events=new o.core.Events,n(17)(o.events),o.ajax=new o.core.Ajax(window&&window.csrfToken?{headers:{"X-CSRF-Token":window.csrfToken}}:null),n(18)(o),o.createModulePrototype=function(){return Object.create(o.core.BaseDOMConstructor.prototype)},o.registerInstanceType=o.instancesController.registerInstanceType.bind(o.instancesController),o.addInstance=o.instancesController.addInstance.bind(o.instancesController),o.removeInstance=o.instancesController.removeInstance.bind(o.instancesController),o.getInstance=o.instancesController.getInstance.bind(o.instancesController),o.getInstances=o.instancesController.getInstances.bind(o.instancesController),o.closest=s.helpers.domTools.closest,o.resolveKeyPath=s.tools.resolveKeyPath,e.exports=o},function(e,t,n){const s={Ajax:n(5),BaseDOMConstructor:n(6),DomMutations:n(7),Events:n(0),InstancesController:n(8)},o={DOMEvents:n(9),domTools:n(10),LikeFormData:n(1),tools:n(11)},r={core:s,helpers:o,tools:o.tools};e.exports=r},function(e,t,n){const s=n(0),o=n(1),r=function(e){this.currentRequests=0,this.events=new s(["beforeSend","load"]),e&&e.headers&&(this.headers=Object.assign(this.headers,e.headers))};r.prototype.headers={"X-Requested-With":"XMLHttpRequest"},r.prototype.send=function(e){const t=this;let n;null!==e.data&&void 0!==e.data&&"undefined"!==e.data||(e.data=null),e.method||(e.method="POST"),e.headers=e.headers?Object.assign(e.headers,this.headers,e.headers):{...this.headers};const s=new Promise((s,r)=>{e.url||(console.error("You should provide url"),r("You should provide url")),t.currentRequests+=1;let i,a=!1;"undefined"!=typeof window&&window.XDomainRequest&&window.XMLHttpRequest&&void 0===(new XMLHttpRequest).responseType&&0===window.url.indexOf("http")?(n=new window.XDomainRequest,a=!0,n.onprogress=function(t){e.onProgress&&e.onProgress(t)}):(n=new XMLHttpRequest,e.onProgress&&n.upload.addEventListener("progress",t=>{t.lengthComputable&&e.onProgress(t.loaded,t.total)},!1)),n.open(e.method,e.url),n.onload=function(){t.currentRequests-=1;const o=t._parseJSON(n);o.status?o.status>199&&o.status<300?s(o):o.status>399&&o.status<600?r(o):(console.error("unknown status %d. Rejecting",o.status),r(o)):a?s(o):r(o),e.response=o,t.events.trigger("load",e)},n.onerror=function(){t.currentRequests-=1,r(Error("Network Error"),n)},t.events.trigger("beforeSend",e),null!==e.data?a?i=`IEJSON${JSON.stringify(e.data)}`:(-1!==e.data.toString().indexOf("FormData")?i=e.data:(i=new o(e.data),e.headers["content-type"]=i.getContentTypeHeader()),t._setHeaders(n,e.headers)):i=null;try{n.send(i)}catch(e){n.send(i.toString())}return n});return e.isReturnXHRToo?[s,n]:s},r.prototype._setHeaders=function(e,t){Object.keys(t).forEach(n=>{t.hasOwnProperty(n)&&e.setRequestHeader(n,t[n])})},r.prototype._parseJSON=function(e){e.response||(e.response=e.responseText);let t={},n=!1;if(e.getResponseHeader&&(n=e.getResponseHeader("Content-Type")),n&&"application/json"!==n.toLowerCase()&&"text/json"!==n.toLowerCase()&&"inode/symlink"!==n.toLowerCase())t={data:e.response};else try{t=JSON.parse(e.response)}catch(n){console.error("Not a JSON!",e.response),t={data:e.response}}return t.status||(t.status=e.status),"string"==typeof t.status&&0===t.status.indexOf("HTTP/")&&t.status.match(/ (\d\d\d)/)&&(t.status=parseInt(t.status.match(/ (\d\d\d)/)[1],10)),t.statusText||(t.statusText=e.statusText),e.status&&e.status!==t.status&&console.warn("Status from request %d, but response contains status %d",e.status,t.status),t},e.exports=r},function(e,t){const n=function(){};n.prototype.init=function(e,t,n){this.sf=e,this.node=t,this.options=Object.assign(this.grabOptions(t),n)},n.prototype.optionsToGrab={},n.prototype.grabOptions=function(e){const t={};let n,s;return Object.keys(this.optionsToGrab).forEach(o=>{this.optionsToGrab.hasOwnProperty(o)&&(n=null,this.optionsToGrab.hasOwnProperty(o)&&((s=this.optionsToGrab[o]).hasOwnProperty("value")&&(n=s.value),this.sf.options.instances[this.name]&&this.sf.options.instances[this.name].hasOwnProperty(o)&&(n=this.sf.options.instances[this.name][o]),s.hasOwnProperty("domAttr")&&e.attributes.hasOwnProperty(s.domAttr)&&(n=e.attributes[s.domAttr].value),s.hasOwnProperty("processor")&&(n=s.processor.call(this,e,n,s)),null!==n&&(t[o]=n)))}),t},e.exports=n},function(e,t){const n=function(e){if(!e)return void console.error("You should provide instancesController  for DOM Mutation. Because DOM Mutation  should known all classes and");if(!this.constructor)return void console.error("Please call DomMutations with new  - 'new DomMutations()' ");this.instancesController=e;const t=this;this.observer=new MutationObserver((function(){t.onDomMutate.apply(t,arguments)})),this.observer.observe(document,{attributes:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["class"]})};n.prototype.onDomMutate=function(e){const t=this.instancesController.getClasses(),n=`.${t.join(",.")}`;return 1!==n.length&&(e.forEach((function(e){switch(e.type){case"attributes":this.processMutationAttributes(e,t);break;case"characterData":break;case"childList":this.processMutationChildList(e.addedNodes,"addInstance",n,t),this.processMutationChildList(e.removedNodes,"removeInstance",n,t);break;case"default":default:console.error("Something wrong. Contact tech support")}}),this),!0)},n.prototype.processMutationAttributes=function(e,t){const n=this,s=e.target.className.split(" "),o=e.oldValue?e.oldValue.split(" "):[],r=s.filter(e=>-1===o.indexOf(e)),i=o.filter(e=>-1===s.indexOf(e)),a=r.filter(e=>-1!==t.indexOf(e));i.filter(e=>-1!==t.indexOf(e)).forEach(t=>{n.instancesController.removeInstance(n.instancesController.getInstanceNameByCssClass(t),e.target)}),a.forEach(t=>{n.instancesController.addInstance(n.instancesController.getInstanceNameByCssClass(t),e.target)})},n.prototype.processMutationChildList=function(e,t,n,s){const o=this;function r(e){s.forEach(n=>{e.classList.contains(n)&&o.instancesController[t](o.instancesController.getInstanceNameByCssClass(n),e)})}[].forEach.call(e,e=>1===e.nodeType&&"SCRIPT"!==e.nodeName&&"LINK"!==e.nodeName&&(r(e),[].forEach.call(e.querySelectorAll(n),r),!0))},n.prototype.stopObserve=function(){this.observer.disconnect()},e.exports=n},function(e,t){const n=function(e){this.spiral=e,this.constructor?this._storage={instancesConstructors:{cssClasses:{},jsConstructors:{}},addons:{},instances:{}}:console.error("Please call InstancesController with new  - 'new InstancesController()' ")};n.prototype.registerInstanceType=function(e,t,n){const s=e.prototype.name;if(s||console.error("Instance constructor should have name inside it"),this._storage.instancesConstructors.jsConstructors.hasOwnProperty(s))console.error("Instance Constructor for type '%s' already added. Skipping",s);else if(t&&(this._storage.instancesConstructors.cssClasses[t]=s),this._storage.instancesConstructors.jsConstructors[s]=e,this._storage.instances[s]=[],!n){const e=document.getElementsByClassName(t);for(let t=0,n=e.length;t<n;t+=1)this.addInstance(s,e[t])}},n.prototype.addInstanceType=function(e,t,n){return console.warn("addInstanceType is deprecated. Please use registerInstanceType instead"),this.registerInstanceType(t,n)},n.prototype.addInstance=function(e,t,n){const s=this._storage.instancesConstructors.jsConstructors[e],o=this.getInstance(e,t);if(!s||o)return!1;const r=new s(this.spiral,t,n);return this._storage.instances[e].push({node:t,instance:r}),r},n.prototype.removeInstance=function(e,t){const n=this.getInstance(e,t,!0);if(!n)return!1;n.instance.die();const s=this._storage.instances[e].indexOf(n);return-1!==s&&this._storage.instances[e].splice(s,1),!0},n.prototype.getInstance=function(e,t,n){const s=this._storage.instances[e];let o=!1;if(!s)return!1;if(!(t=t instanceof HTMLElement?t:document.getElementById(t)))return!1;for(let e=0,r=s.length;e<r;e+=1)if(s[e].node===t){o=n?s[e]:s[e].instance;break}return o},n.prototype.getInstances=function(e){return this._storage.instances[e]||!1},n.prototype.registerAddon=function(e,t,n,s){this._storage.addons.hasOwnProperty(t)||(this._storage.addons[t]={}),this._storage.addons[t].hasOwnProperty(n)||(this._storage.addons[t][n]={}),this._storage.addons[t][n].hasOwnProperty(s)?console.error("The %s addon type %s already registered for instance %s! Skipping registration.",s,n,t):this._storage.addons[t][n][s]=e},n.prototype.getInstanceAddon=function(e,t,n){return!!(this._storage.addons.hasOwnProperty(e)&&this._storage.addons[e].hasOwnProperty(t)&&this._storage.addons[e][t].hasOwnProperty(n))&&this._storage.addons[e][t][n]},n.prototype.getClasses=function(){return Object.keys(this._storage.instancesConstructors.cssClasses)},n.prototype.getInstanceNameByCssClass=function(e){return this._storage.instancesConstructors.cssClasses[e]},n.prototype.getInstanceConstructors=function(){},e.exports=n},function(e,t){const n=function(){this._DOMEventsStorage=[]};n.prototype.add=function(e){"[object Array]"!==Object.prototype.toString.call([])&&(e=[e]),e.forEach((function(e){e.useCapture=!!e.useCapture,e.DOMNode.addEventListener(e.eventType,e.eventFunction,e.useCapture),this._DOMEventsStorage.push(e)}),this)},n.prototype.remove=function(){console.warn("TODO IMPLEMENT")},n.prototype.removeAll=function(){this._DOMEventsStorage.forEach(e=>{e.DOMNode.removeEventListener(e.eventType,e.eventFunction,e.useCapture)}),this._DOMEventsStorage=[]},e.exports=n},function(e,t){e.exports={closest(e,t){let n;const s=(t="string"==typeof t?[t]:t).length,o=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;for(;e&&e.parentNode;){for(n=0;n<s;n+=1)if(o.call(e,t[n]))return e;e=e.parentNode}return!1},closestByClassName(e,t){let n;const s=(t="string"==typeof t?[t]:t).length;for(;e&&e.parentNode;){for(n=0;n<s;n+=1){const s=new RegExp(`(\\s|^)${t[n]}(\\s|$)`);if(e.className.match(s))return e}e=e.parentNode}return!1}}},function(e,t){const n={resolveKeyPath:(e,t,n)=>e.split(".").reduce((e,t)=>n?e?e[t]:void 0:e[t],t||self)};e.exports=n},function(e,t){!function(){let e;const t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];let{length:s}=n;const o=window.console=window.console||{};for(;s--;)o[e=n[s]]||(o[e]=t)}()},function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1;e<arguments.length;e+=1){const n=arguments[e];null!=n&&Object.keys(n).forEach(e=>{n.hasOwnProperty(e)&&(t[e]=n[e])})}return t})},function(e,t,n){(function(t,n){
/*!
       * @overview es6-promise - a tiny implementation of Promises/A+.
       * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
       * @license   Licensed under MIT license
       *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
       * @version   v4.2.8+1e68dce6
       */
var s;s=function(){"use strict";function e(e){return"function"==typeof e}var s=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,r=void 0,i=void 0,a=function(e,t){h[o]=e,h[o+1]=t,2===(o+=2)&&(i?i(m):b())},c="undefined"!=typeof window?window:void 0,l=c||{},u=l.MutationObserver||l.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(m,1)}}var h=new Array(1e3);function m(){for(var e=0;e<o;e+=2)(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0;o=0}var _,y,g,v,b=void 0;function w(e,t){var n=this,s=new this.constructor(C);void 0===s[O]&&R(s);var o=n._state;if(o){var r=arguments[o-1];a((function(){return I(o,s,r,n._result)}))}else D(n,s,e,t);return s}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(C);return T(t,e),t}p?b=function(){return t.nextTick(m)}:u?(y=0,g=new u(m),v=document.createTextNode(""),g.observe(v,{characterData:!0}),b=function(){v.data=y=++y%2}):d?((_=new MessageChannel).port1.onmessage=m,b=function(){return _.port2.postMessage(0)}):b=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(r=e.runOnLoop||e.runOnContext)?function(){r(m)}:f()}catch(e){return f()}}():f();var O=Math.random().toString(36).substring(2);function C(){}var M=void 0,P=1,A=2;function x(t,n,s){n.constructor===t.constructor&&s===w&&n.constructor.resolve===E?function(e,t){t._state===P?S(e,t._result):t._state===A?k(e,t._result):D(t,void 0,(function(t){return T(e,t)}),(function(t){return k(e,t)}))}(t,n):void 0===s?S(t,n):e(s)?function(e,t,n){a((function(e){var s=!1,o=function(e,t,n,s){try{e.call(t,n,s)}catch(e){return e}}(n,t,(function(n){s||(s=!0,t!==n?T(e,n):S(e,n))}),(function(t){s||(s=!0,k(e,t))}),e._label);!s&&o&&(s=!0,k(e,o))}),e)}(t,n,s):S(t,n)}function T(e,t){if(e===t)k(e,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(s=t),null===s||"object"!==o&&"function"!==o)S(e,t);else{var n=void 0;try{n=t.then}catch(t){return void k(e,t)}x(e,t,n)}var s,o}function j(e){e._onerror&&e._onerror(e._result),L(e)}function S(e,t){e._state===M&&(e._result=t,e._state=P,0!==e._subscribers.length&&a(L,e))}function k(e,t){e._state===M&&(e._state=A,e._result=t,a(j,e))}function D(e,t,n,s){var o=e._subscribers,r=o.length;e._onerror=null,o[r]=t,o[r+P]=n,o[r+A]=s,0===r&&e._state&&a(L,e)}function L(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var s=void 0,o=void 0,r=e._result,i=0;i<t.length;i+=3)s=t[i],o=t[i+n],s?I(n,s,o,r):o(r);e._subscribers.length=0}}function I(t,n,s,o){var r=e(s),i=void 0,a=void 0,c=!0;if(r){try{i=s(o)}catch(e){c=!1,a=e}if(n===i)return void k(n,new TypeError("A promises callback cannot return that same promise."))}else i=o;n._state!==M||(r&&c?T(n,i):!1===c?k(n,a):t===P?S(n,i):t===A&&k(n,i))}var F=0;function R(e){e[O]=F++,e._state=void 0,e._result=void 0,e._subscribers=[]}var B=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(C),this.promise[O]||R(this.promise),s(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&S(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===M&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,s=n.resolve;if(s===E){var o=void 0,r=void 0,i=!1;try{o=e.then}catch(e){i=!0,r=e}if(o===w&&e._state!==M)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===N){var a=new n(C);i?k(a,r):x(a,e,o),this._willSettleAt(a,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(s(e),t)},e.prototype._settledAt=function(e,t,n){var s=this.promise;s._state===M&&(this._remaining--,e===A?k(s,n):this._result[t]=n),0===this._remaining&&S(s,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;D(e,void 0,(function(e){return n._settledAt(P,t,e)}),(function(e){return n._settledAt(A,t,e)}))},e}(),N=function(){function t(e){this[O]=F++,this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){T(e,t)}),(function(t){k(e,t)}))}catch(t){k(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return N.prototype.then=w,N.all=function(e){return new B(this,e).promise},N.race=function(e){var t=this;return s(e)?new t((function(n,s){for(var o=e.length,r=0;r<o;r++)t.resolve(e[r]).then(n,s)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},N.resolve=E,N.reject=function(e){var t=new this(C);return k(t,e),t},N._setScheduler=function(e){i=e},N._setAsap=function(e){a=e},N._asap=a,N.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var s=null;try{s=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===s&&!t.cast)return}e.Promise=N},N.Promise=N,N},e.exports=s()}).call(this,n(15),n(16))},function(e,t){var n,s,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{s="function"==typeof clearTimeout?clearTimeout:i}catch(e){s=i}}();var c,l=[],u=!1,p=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):p=-1,l.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(c=l,l=[];++p<t;)c&&c[p].run();p=-1,t=l.length}c=null,u=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new h(e,t)),1!==l.length||u||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){e.on("redirect",e=>{const t="[object String]"===Object.prototype.toString.call(e)?e:e.url;if(/^(?:[a-z]+:)?\/\//i.test(t))self.location.href=t;else{const e=window.location.origin||`${window.location.protocol}//${window.location.hostname}${window.location.port?`:${window.location.port}`:""}`;self.location.href=e+("/"===t.charAt(0)?t:`/${t}`)}}),e.on("reload",()=>{window.location.reload()}),e.on("refresh",()=>{e.trigger("reload")}),e.on("close",()=>{self.close()})}},function(e,t){e.exports=function(e){e.ajax.events.on("load",t=>{const{response:n}=t;if(n.hasOwnProperty("action"))if("string"==typeof n.action)e.events.trigger(n.action);else if("object"==typeof n.action){const s=Object.keys(n.action);if(-1!==s.indexOf("flash")){const{flash:e}=n.action,t=Date.now();let s={};"object"==typeof n.action.flash?(s=e).timestamp=t:s={message:e,timestamp:t},sessionStorage.setItem("sfFlashMessage",JSON.stringify(s))}-1!==s.indexOf("redirect")?setTimeout(()=>{e.events.trigger("redirect",n.action.redirect,t)},+n.action.delay||0):-1!==s.indexOf("name")&&setTimeout(()=>{e.events.trigger(n.action.name,n.action.url)},+n.action.delay||0)}else console.error("Action from server. Something wrong. ",n.action)}),function(e){if(!e)return;const t=JSON.parse(e);let n;if(Date.now()-t.timestamp>1e4)return;n="debug"===t.type||"success"===t.type?"debug":"info"!==t.type&&t.type&&"notice"!==t.type?"danger":"info";const s=document.createElement("div"),o=document.createElement("div");o.classList.add("flash-wrapper"),s.classList.add("flash",n),s.innerHTML=t.message,document.body.appendChild(o),o.appendChild(s),setTimeout(()=>{o.classList.add("show")},1),setTimeout(()=>{o.classList.remove("show")},t.timeout||5e3),sessionStorage.removeItem("sfFlashMessage")}(sessionStorage.getItem("sfFlashMessage"))}}])},,function(e,t,n){const s=n(0),o=n(3).default;s.instancesController.registerInstanceType(o,"sf-js-input"),e.exports=o},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var s=n(0),o=n.n(s);const r=function(e,t,n){this._construct(e,t,n)};r.prototype=Object.create(o.a.core.BaseDOMConstructor.prototype),r.prototype.name="input",r.prototype._construct=function(e,t,n){this.init(e,t,n),n&&(this.options=e.tools.extend(this.options,n)),this.els={node:t},this.options.prefix?(this.setPrefix(),this.addPrefixEventListeners()):this.options.pattern&&(this.setupPattern(),this.addPatternEventListeners())},r.prototype.optionsToGrab={pattern:{domAttr:"data-pattern"},prefix:{domAttr:"data-prefix"}},r.prototype.isValidPattern=function(){return this.els.node.value.match(this.pattern)},r.prototype.addPatternEventListeners=function(){const e=this;this._inputKeyPress=function(t){const n=String.fromCharCode(t.keyCode),{value:s}=e.els.node,o=e.getCursorPosition();if(n.length>0){t.preventDefault();let r=1;for(let t=o;t<s.length&&-1!==e.formatCharacters.indexOf(s[t]);t+=1)r+=1;const i=s.substring(0,o+r-1)+n+s.substring(o+r,s.length);return!!i.match(e.patternWithEmpty)&&(e.els.node.value=i,e.setCursorPosition(o+r),!1)}return!0},this.els.node.addEventListener("keypress",this._inputKeyPress),this._inputFocus=function(t){t.preventDefault(),setTimeout(()=>{""===e.els.node.value&&(e.els.node.value=e.patternString.replace(/[^\-\(\)\[\]\:\.\,\$\%\@\ \/]/g,"_"),e.setCursorPosition(0))},0)},this.els.node.addEventListener("focus",this._inputFocus),this._inputKeyDown=function(t){const n=String.fromCharCode(t.keyCode),{value:s}=e.els.node,o=e.getCursorPosition();if(8===t.keyCode||46===t.keyCode){t.preventDefault();let n=0;for(let t=o-1;t>0&&-1!==e.formatCharacters.indexOf(s[t]);t-=1)n-=1;const r=`${s.substring(0,o+n-1)}_${s.substring(o+n,s.length)}`;return!!r.match(e.patternWithEmpty)&&(console.log(r),e.els.node.value=r,e.setCursorPosition(o+n-1),!1)}return!n.match(/\W/)},this.els.node.addEventListener("keydown",this._inputKeyDown),this._inputBlur=function(){e.els.node.value.match(e.pattern)||(e.els.node.value="")},this.els.node.addEventListener("blur",this._inputBlur)},r.prototype.getCursorPosition=function(){let e=0;if(document.selection){this.els.node.focus();const t=document.selection.createRange();t.moveStart("character",-this.els.node.value.length),e=t.text.length}else(this.els.node.selectionStart||"0"===this.els.node.selectionStart)&&(e=this.els.node.selectionStart);return e},r.prototype.setCursorPosition=function(e){if(this.els.node.createTextRange){const t=this.els.node.createTextRange();t.move("character",e),t.select()}else this.els.node.selectionStart?(this.els.node.focus(),this.els.node.selectionStart=e,this.els.node.selectionEnd=e):this.els.node.focus()},r.prototype.setupPattern=function(){this.formatCharacters=this.els.node.getAttribute("data-format-characters")||"-()[]:.,$%@ /",this.patternString=this.options.pattern,this.els.node.placeholder=this.patternString,function(){let e="",t="";for(let n=0;n<this.patternString.length;n+=1){const s=this.patternString[n];this.formatCharacters.indexOf(s)>=0?(e+=s,t+=s):s.match(/[0-9]/)?(e+="[0-9]",t+="([0-9]|_)"):s.match(/[a-zA-Z]/)?(e+="[a-zA-Z]",t+="([a-zA-Z]|_)"):"*"===s&&(e+="[0-9a-zA-Z]",t+="([0-9a-zA-Z]|_)")}this.pattern=new RegExp(`^${e}$`,"g"),this.patternWithEmpty=new RegExp(`^${t}$`,"g")}.bind(this)()},r.prototype.addPrefixEventListeners=function(){const e=this;this._inputKeyup=function(){const t=this.getAttribute("data-prefix");0!==e.els.node.value.indexOf(t)&&(e.els.node.value=`${t} `)},this.els.node&&this.els.node.addEventListener("keyup",this._inputKeyup)},r.prototype.removePatternEventListeners=function(){this.els.node&&(this.els.node.addEventListener("keypress",this._inputKeyPress),this.els.node.addEventListener("focus",this._inputFocus),this.els.node.addEventListener("keydown",this._inputKeyDown),this.els.node.addEventListener("blur",this._inputBlur))},r.prototype.removePrefixEventListeners=function(){this.els.node&&this.els.node.removeEventListener("keyup",this._inputKeyup)},r.prototype.die=function(){this.options.pattern?this.removePatternEventListeners():this.options.prefix&&this.removePrefixEventListeners()},r.prototype.setPrefix=function(){this.els.node.value=`${this.options.prefix} ${this.els.node.value}`}},function(e,t,n){var s;window,e.exports=(s=n(0),function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([function(e,t){e.exports=s},function(e,t,n){e.exports=n(2)},function(e,t,n){const s=n(0),o=n(3).default;s.registerInstanceType(o),e.exports=o},function(e,t,n){"use strict";n.r(t);var s=n(0),o=n.n(s);n(4);const r=function(e,t,n){this._construct(e,t,n)};(r.prototype=o.a.createModulePrototype()).name="lock",r.prototype._construct=function(e,t,n){this.init(e,t,n),this.add(this.options.type,this.node)},r.prototype.add=function(e,t){if(!this.types.hasOwnProperty(e))return!1;const n=document.createElement("div");return n.classList.add(this.types[e].className||"js-sf-lock"),n.classList.add("locker"),n.innerHTML=this.types[e].html,t.appendChild(n),t.classList.add("locked"),this.types[e].progress},r.prototype.die=function(){this.remove()},r.prototype.remove=function(){this.node.classList.remove("locked");const e=this.node.querySelector(".js-sf-lock");return e&&this.node.removeChild(e),!0},r.prototype.types={spinner:{html:'<div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div>'},progress:{html:'<div class="progress"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"></div></div>',progress(e,t){this.context.getElementsByClassName("progress-bar")[0].style.width=`${e/t*100}%`}}},r.prototype.types.default=r.prototype.types.spinner,t.default=r},function(e,t,n){var s=n(5);"string"==typeof s&&(s=[[e.i,s,""]]),n(7)(s,{insert:"head",singleton:!1}),s.locals&&(e.exports=s.locals)},function(e,t,n){(e.exports=n(6)(!0)).push([e.i,".locked .form-content {\n  pointer-events: none;\n  filter: blur(3px);\n  opacity: .7;\n}\n\n.locker {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  width: 80%;\n  text-align: center;\n}\n","",{version:3,sources:["styles.css"],names:[],mappings:"AAAA;EACE,oBAAoB;EACpB,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,UAAU;EACV,kBAAkB;AACpB",file:"styles.css",sourcesContent:[".locked .form-content {\n  pointer-events: none;\n  filter: blur(3px);\n  opacity: .7;\n}\n\n.locker {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  width: 80%;\n  text-align: center;\n}\n"]}])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,s,o,r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var a=(n=i,s=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(o," */")),c=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot).concat(e," */")}));return[r].concat(c).concat([a]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var s={},o=0;o<this.length;o++){var r=this[o][0];null!=r&&(s[r]=!0)}for(var i=0;i<e.length;i++){var a=e[i];null!=a[0]&&s[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="(".concat(a[2],") and (").concat(n,")")),t.push(a))}},t}},function(e,t,n){"use strict";var s,o={},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function i(e,t){for(var n=[],s={},o=0;o<e.length;o++){var r=e[o],i=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};s[i]?s[i].parts.push(a):n.push(s[i]={id:i,parts:[a]})}return n}function a(e,t){for(var n=0;n<e.length;n++){var s=e[n],r=o[s.id],i=0;if(r){for(r.refs++;i<r.parts.length;i++)r.parts[i](s.parts[i]);for(;i<s.parts.length;i++)r.parts.push(m(s.parts[i],t))}else{for(var a=[];i<s.parts.length;i++)a.push(m(s.parts[i],t));o[s.id]={id:s.id,refs:1,parts:a}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var s=n.nc;s&&(e.attributes.nonce=s)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var o=r(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,u=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function p(e,t,n,s){var o=n?"":s.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var r=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(r,i[t]):e.appendChild(r)}}function d(e,t,n){var s=n.css,o=n.media,r=n.sourceMap;if(o&&e.setAttribute("media",o),r&&btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var f=null,h=0;function m(e,t){var n,s,o;if(t.singleton){var r=h++;n=f||(f=c(t)),s=p.bind(null,n,r,!1),o=p.bind(null,n,r,!0)}else n=c(t),s=d.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var n=i(e,t);return a(n,t),function(e){for(var s=[],r=0;r<n.length;r++){var c=n[r],l=o[c.id];l&&(l.refs--,s.push(l))}e&&a(i(e,t),t);for(var u=0;u<s.length;u++){var p=s[u];if(0===p.refs){for(var d=0;d<p.parts.length;d++)p.parts[d]();delete o[p.id]}}}}}]))},function(module,exports,__webpack_require__){var t;window,t=function(__WEBPACK_EXTERNAL_MODULE__1__){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=4)}([function(e,t){const n={template:'<div class="alert alert-${type} alert-dismissible fade show" role="alert">${text}<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>',close:".close",place:"bottom",levels:{success:"success",info:"info",warning:"warning",error:"error"},field:"[data-field]",fieldCheck:"[data-check]",fieldElement:"[data-input]",fieldTemplate:'<div class="invalid-feedback" data-form-message>${text}</div>',fieldPlace:"bottom",fieldClasses:{success:"is-valid",info:"is-valid",warning:"is-invalid",error:"is-invalid"}};function s(e,t){return"object"!=typeof e&&(e={text:e,type:t}),e.text=e.text||e.message||e,e.type=e.type||t,e}n.levels.message=n.levels.success,n.levels.debug=n.levels.success,n.levels.info=n.levels.notice=n.levels.info,n.levels.danger=n.levels.critical=n.levels.alert=n.levels.emergency=n.levels.error,e.exports={defaults:n,showMessages(e){if(!e)return;let t=!1;const n=this;if(Object.keys(this.options.messages.levels).forEach(n=>{e[n]&&(this.showFormMessage(e[n],this.options.messages.levels[n]),t=!0)}),e.messages&&(this.showFieldsMessages(e.messages,"success"),t=!0),e.errors&&(this.showFieldsMessages(e.errors,"error"),t=!0),e.warnings&&(this.showFieldsMessages(e.warnings,"warning"),t=!0),!t&&e.status>300){let t=e.status?`${e.status} `:"";t+=e.statusText?e.statusText:"",t+=e.data&&!e.statusText?e.data:"",t+=0===t.length?e:"",this.showFormMessage(t,"error")}this._messages.forEach(e=>{e.close&&(e.closeHandler=n.removeMessage.bind(n,e),e.close.addEventListener("click",e.closeHandler))})},removeMessage(e,t){if(e.close&&e.close.removeEventListener("click",e.closeHandler),e.el.parentNode.removeChild(e.el),e.field){const t=e.field.querySelector(this.options.messages.fieldElement);t?t.classList.remove(this.options.messages.fieldClasses[e.type]):e.field.classList.remove(this.options.messages.fieldClasses[e.type])}t&&(t.preventDefault&&t.preventDefault(),this._messages.splice(this._messages.indexOf(e),1))},removeMessages(){const e=this;this._messages&&this._messages.forEach(t=>{e.removeMessage(t,!1)}),e._messages=[]},showFormMessage(e,t){let n,o=this.options.messages.template;e=s(e,t),Object.keys(e).forEach(t=>{e.hasOwnProperty(t)&&(o=o.replace(`\${${t}}`,e[t]))});const r=document.createElement("div");r.innerHTML=o;const i=r.firstChild;"bottom"===this.options.messages.place?this.node.appendChild(i):"top"===this.options.messages.place?this.node.insertBefore(i,this.node.firstChild):(n=document.querySelector(this.options.messages.place)).appendChild(i),this._messages.push({el:i,close:i.querySelector(this.options.messages.close)})},showFieldMessage(e,t,n,o){let r=o?e:window.sf.helpers.domTools.closest(e,this.options.messages.field),i=this.options.messages.fieldTemplate;if(!r)return;t=s(t,n);const a=r.querySelector(this.options.messages.fieldElement),c=r.querySelector(this.options.messages.fieldCheck);a?a.classList.add(this.options.messages.fieldClasses[n]):r.classList.add(this.options.messages.fieldClasses[n]),Object.keys(t).forEach(e=>{t.hasOwnProperty(e)&&(i=i.replace(`\${${e}}`,t[e]))});const l=document.createElement("div");l.innerHTML=i;const u=l.firstChild;"bottom"===this.options.messages.fieldPlace?c?c.appendChild(u):a?r.insertBefore(u,a.nextSibling):r.appendChild(u):"top"===this.options.messages.fieldPlace?r.insertBefore(u,r.firstChild):(r=r.querySelector(this.options.messages.fieldPlace)).appendChild(u),this._messages.push({el:u,close:u.querySelector(this.options.messages.fieldClose),field:r,type:n})},showFieldsMessages(e,t){const n=this;window.sf.iterateInputs(this.node,e,(e,s)=>{n.showFieldMessage(e,s,t)}).forEach(e=>{Object.keys(e).forEach(s=>{const o=n.node.querySelector(`[data-message-placeholder="${s}"]`);o&&n.showFieldMessage(o,e[s],t,!0)})})}}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(e,t){const n=function(e){return!!e&&(this.formRef=e,this.keyRegex=/[^\[\]]+/g,this.$form=null,this.$formElements=[],this.formObj={},!!this.setForm()&&!!this.setFormElements()&&this.setFormObj())};n.prototype.setForm=function(){switch(typeof this.formRef){case"string":this.$form=document.getElementById(this.formRef);break;case"object":this.isDomNode(this.formRef)&&(this.$form=this.formRef)}return this.$form},n.prototype.setFormElements=function(){return this.$formElements=this.$form.querySelectorAll("input, textarea, select"),this.$formElements.length},n.prototype.isDomNode=function(e){return"object"==typeof e&&"nodeType"in e&&1===e.nodeType},n.prototype.forEach=function(e,t){[].forEach?[].forEach.call(e,t):Object.keys(e).forEach(n=>{Object.prototype.hasOwnProperty.call(e,n)&&t.call(e,e[n])})},n.prototype.addChild=function(e,t,n,s){if(1===n.length){if("INPUT"===t.nodeName&&"radio"===t.type)return t.checked?void(e[n]=s):void 0;if("INPUT"===t.nodeName&&"checkbox"===t.type)return t.checked?(e[n]||(e[n]=[]),void e[n].push(s)):void 0;if("SELECT"===t.nodeName&&"select-multiple"===t.type){e[n]=[];const s=t.querySelectorAll("option[selected]");return void(s&&this.forEach(s,t=>{e[n].push(t.value)}))}e[n]=s}n.length>1&&(e[n[0]]||(e[n[0]]={}),this.addChild(e[n[0]],t,n.splice(1,n.length),s))},n.prototype.setFormObj=function(){let e,t=0;for(t=0;t<this.$formElements.length;t+=1)this.$formElements[t].name&&!this.$formElements[t].disabled&&(e=this.$formElements[t].name.match(this.keyRegex),this.addChild(this.formObj,this.$formElements[t],e,this.$formElements[t].value));return this.formObj},e.exports=n},function(e,t){let n=[];e.exports=function(e,t,s,o){return n=[],function e(t,s,o,r){Object.keys(s).forEach(i=>{if(!s.hasOwnProperty(i))return;const a=r?`${r}[${i}]`:i,c=Object.prototype.toString.call(s[i]),l=`[name='${a}']`;switch(c){case"[object Object]":e(t,s[i],o,a);break;case"[object Array]":s[i].forEach(e=>{const s=`[name='${a}[]'][value='${e}']`,r=t.querySelectorAll(s);0===r.length&&n.push(s);for(let e=0,t=r.length;e<t;e+=1)o(r[e],!0)});break;case"[object String]":case"[object Number]":const r=t.querySelectorAll(l);if(0===r.length){const e={};e[a]=s[i],n.push(e)}for(let e=0,t=r.length;e<t;e+=1)o(r[e],s[i]);break;default:console.error("unknown type -",c," and message",s[i])}})}(e,t,s,o),n.length,n}},function(e,t,n){e.exports=n(5)},function(e,t,n){const s=n(1),o=n(6).default;s.registerInstanceType(o,"js-sf-form"),e.exports=o},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _spiral_toolkit_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_spiral_toolkit_core__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_spiral_toolkit_core__WEBPACK_IMPORTED_MODULE_0__),_formToObject__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_formToObject__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_formToObject__WEBPACK_IMPORTED_MODULE_1__),_formMessages__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),_formMessages__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_formMessages__WEBPACK_IMPORTED_MODULE_2__),_iterateInputs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3),_iterateInputs__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_iterateInputs__WEBPACK_IMPORTED_MODULE_3__),_styles_css__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7),_styles_css__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_styles_css__WEBPACK_IMPORTED_MODULE_4__);const Form=function(e,t,n){this._construct(e,t,n)};Form.prototype=_spiral_toolkit_core__WEBPACK_IMPORTED_MODULE_0___default.a.createModulePrototype(),Form.prototype.name="form",Form.prototype._construct=function(e,t,n){this.init(e,t,n),this.mixMessagesOptions(),this.DOMEvents=new this.sf.helpers.DOMEvents,this.addEvents(),this.events=new this.sf.core.Events(["beforeSend","success","error","always"]),_spiral_toolkit_core__WEBPACK_IMPORTED_MODULE_0___default.a.iterateInputs=_iterateInputs__WEBPACK_IMPORTED_MODULE_3___default.a},Form.prototype.optionsToGrab={context:{processor:e=>e},self:{processor(){return this}},url:{domAttr:"action",value:"/"},method:{domAttr:"method",value:"POST"},lockType:{value:"default",domAttr:"data-lock-type"},messagesType:{value:"spiral",domAttr:"data-messagesType"},messages:{value:"",domAttr:"data-messages",processor(e,t,n){if(!t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){console.error("Form JSON.parse error: ",e)}return Object.assign(n.value,t)}},useAjax:{value:!0,domAttr:"data-useAjax",processor:(e,t)=>"boolean"==typeof t?t:("false"===(t=null!=t?t.toLowerCase():"")?t=!1:"true"===t&&(t=!0),t)},ajaxCallback:{value:!1,domAttr:"data-callback"},beforeSubmitCallback:{value:!1,domAttr:"data-before-submit"},afterSubmitCallback:{value:!1,domAttr:"data-after-submit"},headers:{value:{Accept:"application/json"},domAttr:"data-headers",processor(e,t,n){if(void 0===t||null==t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){console.error("Form JSON.parse error: ",e)}return Object.assign(n.value,t)}}},Form.prototype.mixMessagesOptions=function(){const e=this.sf.options.instances.form;this.options.messages={..._formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.defaults,...e&&e.messages&&e.messages[this.options.messagesType],...this.options.messages}},Form.prototype.onSubmit=function(e){if(this.sf.getInstance("lock",this.node))return e.preventDefault(),void e.stopPropagation();this.removeMessages(),this.options.data=this.getFormData(),window.FormData||0===this.options.context.querySelectorAll("input[type='file']").length||(this.options.useAjax=!1),this.events.trigger("beforeSend",this.options),this.options.useAjax&&(this.send(this.options),e.preventDefault(),e.stopPropagation())},Form.prototype.lock=function(e){this.options.lockType&&"none"!==this.options.lockType&&(e?this.sf.removeInstance("lock",this.node)||console.warn("You try to remove 'lock' instance, but it is not available or not started"):this.sf.addInstance("lock",this.node,{type:this.options.lockType})||console.warn("You try to add 'lock' instance, but it is not available or already started"))},Form.prototype.showFormMessage=_formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.showFormMessage,Form.prototype.showFieldMessage=_formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.showFieldMessage,Form.prototype.showFieldsMessages=_formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.showFieldsMessages,Form.prototype.showMessages=_formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.showMessages,Form.prototype.removeMessages=_formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.removeMessages,Form.prototype.removeMessage=_formMessages__WEBPACK_IMPORTED_MODULE_2___default.a.removeMessage,Form.prototype.processAnswer=function(e){this.options.messagesType&&this.showMessages(e)},Form.prototype.send=function(sendOptions){const that=this;if(this.lock(),sendOptions.beforeSubmitCallback){const fn=eval(sendOptions.beforeSubmitCallback);"function"==typeof fn&&fn.call(sendOptions)}this.sf.ajax.send(sendOptions).then(e=>(that.events.trigger("success",sendOptions),e),e=>(that.events.trigger("error",sendOptions),e)).then(e=>{that.lock(!0),that.processAnswer(e),that.events.trigger("always",sendOptions)})},Form.prototype.getFormData=function(){return window.FormData?new FormData(this.options.context):(console.log(`Form \`${this.options.context}\` were processed without FormData.`),new _formToObject__WEBPACK_IMPORTED_MODULE_1___default.a(this.options.context))},Form.prototype.setOptions=function(e){this.options=Object.assign(this.options,e)},Form.prototype.addEvents=function(){const e=this;this.DOMEvents.add([{DOMNode:this.options.context,eventType:"submit",eventFunction(t){e.onSubmit.call(e,t)}}])},Form.prototype.die=function(){this.DOMEvents.removeAll()},__webpack_exports__.default=Form},function(e,t,n){var s=n(8);"string"==typeof s&&(s=[[e.i,s,""]]),n(10)(s,{insert:"head",singleton:!1}),s.locals&&(e.exports=s.locals)},function(e,t,n){(e.exports=n(9)(!0)).push([e.i,"[data-form-message] ~ [data-form-hint] {\n  display: none;\n}\n\n.is-invalid[data-message-placeholder]>.invalid-feedback {\n  display: block;\n}\n","",{version:3,sources:["styles.css"],names:[],mappings:"AAAA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;AAChB",file:"styles.css",sourcesContent:["[data-form-message] ~ [data-form-hint] {\n  display: none;\n}\n\n.is-invalid[data-message-placeholder]>.invalid-feedback {\n  display: block;\n}\n"]}])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,s,o,r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var a=(n=i,s=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(o," */")),c=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot).concat(e," */")}));return[r].concat(c).concat([a]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var s={},o=0;o<this.length;o++){var r=this[o][0];null!=r&&(s[r]=!0)}for(var i=0;i<e.length;i++){var a=e[i];null!=a[0]&&s[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="(".concat(a[2],") and (").concat(n,")")),t.push(a))}},t}},function(e,t,n){"use strict";var s,o={},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function i(e,t){for(var n=[],s={},o=0;o<e.length;o++){var r=e[o],i=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};s[i]?s[i].parts.push(a):n.push(s[i]={id:i,parts:[a]})}return n}function a(e,t){for(var n=0;n<e.length;n++){var s=e[n],r=o[s.id],i=0;if(r){for(r.refs++;i<r.parts.length;i++)r.parts[i](s.parts[i]);for(;i<s.parts.length;i++)r.parts.push(m(s.parts[i],t))}else{for(var a=[];i<s.parts.length;i++)a.push(m(s.parts[i],t));o[s.id]={id:s.id,refs:1,parts:a}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var s=n.nc;s&&(e.attributes.nonce=s)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var o=r(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,u=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function p(e,t,n,s){var o=n?"":s.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var r=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(r,i[t]):e.appendChild(r)}}function d(e,t,n){var s=n.css,o=n.media,r=n.sourceMap;if(o&&e.setAttribute("media",o),r&&btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var f=null,h=0;function m(e,t){var n,s,o;if(t.singleton){var r=h++;n=f||(f=c(t)),s=p.bind(null,n,r,!1),o=p.bind(null,n,r,!0)}else n=c(t),s=d.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var n=i(e,t);return a(n,t),function(e){for(var s=[],r=0;r<n.length;r++){var c=n[r],l=o[c.id];l&&(l.refs--,s.push(l))}e&&a(i(e,t),t);for(var u=0;u<s.length;u++){var p=s[u];if(0===p.refs){for(var d=0;d<p.parts.length;d++)p.parts[d]();delete o[p.id]}}}}}])},module.exports=t(__webpack_require__(0))},,,,,,,,,function(e,t,n){e.exports=n(15)},function(e,t,n){n(0),n(2),n(4),n(5)}])}));
//# sourceMappingURL=toolkit.js.map